---
layout: post
title: "WordPress 5.7.1 Security and Maintenance Release"
---

Today, April 15th, 2021, WordPress released version 5.7.1, a security and maintenance release that reportedly patches two security vulnerabilities.

The [WordPress release announcement](https://wordpress.org/news/2021/04/wordpress-5-7-1-security-and-maintenance-release/) lists the following two security vulnerabilities as being patched in version 5.7.1:

> Thank you [SonarSource](https://www.sonarsource.com/) for reporting an XXE vulnerability within the media library affecting PHP 8.
> Thanks [Mikael Korpela](https://mikaelkorpela.fi/) for reporting a data exposure vulnerability within the REST API.

Let's take a closer look at these vulnerabilities and see what other information we can find out about them.

They have been added to our database as the following:

- [WordPress < 5.7.1 - XXE Within the Media Library Affecting PHP 8](https://wpscan.com/vulnerability/cbbe6c17-b24e-4be4-8937-c78472a138b5)
- [WordPress < 5.7.1 - Sensitive Data Exposure via REST API](https://wpscan.com/vulnerability/6a3ec618-c79e-4b9c-9020-86b157458ac5)

## WordPress < 5.7.1 - XXE Within the Media Library Affecting PHP 8

This vulnerability was an [XML External Entity (XXE)](https://portswigger.net/web-security/xxe) vulnerability affecting the [ID3 PHP library](https://www.getid3.org/), which WordPress uses.

The ID3 library parses ID3 tags from MP3 audio files. [ID3 tags](https://en.wikipedia.org/wiki/ID3) are pieces of metadata about the MP3 audio files, such as the artists, song title, etc.

This vulnerability was found and reported to WordPress by a company called [SonarSource](https://www.sonarsource.com/). The same company that [recently acquired](https://blog.ripstech.com/2020/rips-acquired-by-sonarsource/) the PHP Static Code Analysis company, RIPS Technologies.

RIPS Technologies found and reported many serious security issues to WordPress over the years while in operation. We can assume that it is the same technology that identified this vulnerability.

The vulnerable code was patched by WordPress before it was patched in the ID3 library.

The WordPress patch can be found [here](https://github.com/WordPress/wordpress-develop/commit/60fa61de5b151f8a1f46165f9aec4984ebd2ad87#diff-c411d86e3f3cc24f0cea5d999fc976244be83051edb2f2ce517c21207222e868) and looks like this:

![WordPress 5.7.1 XXE Security vulnerability](/assets/posts/wordpress-571-security/id3-xxe-wordpress.png)

The code comment reads:

> This function has been deprecated in PHP 8.0 because in libxml 2.9.0, external entity loading is disabled by default, but is still needed when LIBXML_NOENT is used.

So what does the patch do?

In the vulnerable version of the code, the ID3 library assumed that it was OK to not explicitly disable XML entities in PHP 8. Using the `libxml_disable_entity_loader()` function in PHP 8 likely gave warnings about its deprecation.

However, one small, but important, detail is that XML entities must still be explicitly disabled if the `LIBXML_NOENT` option is passed to the `simplexml_load_string()` [function](https://www.php.net/manual/en/function.libxml-disable-entity-loader.php), which in the case of ID3, it does. Thus leaving WordPress 5.7.1 and lesser versions that run on PHP version 8 vulnerable to XXE attacks through MP3 audio file uploads.

- The vulnerability was introduced in the ID3 library on [August 11th, 2020](https://github.com/JamesHeinrich/getID3/pull/260).

- The patch to fix the vulnerability in the ID3 library can be found [here](https://github.com/JamesHeinrich/getID3/pull/308).

That means that the vulnerability was exploitable for about eight months. But, according to [WordPress's own statistics](https://wordpress.org/about/stats/) only 0.3% of WordPress users use PHP 8.

![WordPress 5.7.1 PHP 8 Statistics](/assets/posts/wordpress-571-security/wordpress-php-stats.png)

## WordPress < 5.7.1 - Sensitive Data Exposure via REST API

There are no details about this vulnerability at the time of writing, but we will update this page with further details as they become available.

It is not known what sensitive data could have been exposed or what REST API endpoint was affected.

This vulnerability was found and reported to WordPress by [Mikael Korpela](https://mikaelkorpela.fi/).

## Staying Secure

To ensure that you are secured against these vulnerabilities, upgrade to WordPress 5.7.1.

To be notified when these vulnerabilities are added to our [WordPress vulnerability database](https://wpscan.com/), install our [WordPress Security Plugin](https://wordpress.org/plugins/wpscan/).
